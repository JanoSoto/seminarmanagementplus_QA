<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/template2.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core">
    
    <ui:define name="metadata">
        #{accordionPanelMB.setIndex("2")}
        <f:metadata>
            <f:viewParam name="prop" value="#{verPropuestaMB.idPropuesta}"/>
        </f:metadata>
    </ui:define>
    
    <ui:define name="title"><title>Ver Propuesta | Seminar Management</title></ui:define>

    <ui:define name="content">            
            <p:layoutUnit position="west" size="430" style="border: none;">
                #{verPropuestaMB.buscarPropuesta()}
                <p:panel style="border:none;">
                    <h1>Datos Propuesta</h1>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" for="nombre" value="Nombre:"/>
                    <h:outputText id="nombre" style="font-weight: bold;padding-left: 1em;" value="#{verPropuestaMB.propuesta.nombrePropuesta}"/>
                    <br/>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" value="Alumno:"/>
                    <a class="enlace" href="/SeminarManagement-Maven-web/2.0/secretaria/alumnos/alumno.xhtml?alum=#{verPropuestaMB.propuesta.rutAlumno.rutAlumno}">
                        <h:outputText style="padding-left: 1em;" value="#{verPropuestaMB.propuesta.rutAlumno.nombreAlumno} #{verPropuestaMB.propuesta.rutAlumno.apellidoAlumno}"/>
                    </a>
                    <br/>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" value="Fecha:"/>
                    <h:outputText style="padding-left: 1em;" value="#{verPropuestaMB.propuesta.fechaPropuesta}"/>
                    <br/>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" value="Semestre:"/>
                    <h:outputText style="padding-left: 1em;" value="#{verPropuestaMB.propuesta.idSemestre.idSemestre}"/>
                    <br/>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" value="Tiene Comisión Revisora:"/>
                    <h:outputText rendered="#{not empty verPropuestaMB.propuesta.idRevisora}" style="padding-left: 1em;" value="SÍ"/>
                    <h:outputText rendered="#{empty verPropuestaMB.propuesta.idRevisora}" style="padding-left: 1em;" value="NO"/>
                    <br/>
                    <p:outputLabel style="color: #0052cc;font-weight: bold;" value="Tiene Tema:"/>
                    <h:outputText rendered="#{not empty verPropuestaMB.propuesta.idRevisora.idTema}" style="padding-left: 1em;" value="SÍ"/>
                    <h:outputText rendered="#{empty verPropuestaMB.propuesta.idRevisora.idTema}" style="padding-left: 1em;" value="NO"/>
                </p:panel>
                
                
                <p:panel style="border:none;">
                    <h1>Acciones</h1>
                    <h:form>
                        <p:growl id="growl" showDetail="true" sticky="true" />
                        <h:panelGrid columns="1" cellpadding="4">
                            <!--<p:button href="/2.0/secretaria/propuestas/editarProp.xhtml?prop=" value="Editar Propuesta"/>-->
                            <p:button style="width:150px;" rendered="#{empty verPropuestaMB.propuesta.idRevisora}" href="/2.0/secretaria/propuestas/agregarcomrev.xhtml?prop=#{verPropuestaMB.propuesta.idPropuesta}" value="Agregar Comisión Revisora"/>
                            <p:button style="width:150px;" rendered="#{empty verPropuestaMB.propuesta.idRevisora.idTema and not empty verPropuestaMB.propuesta.idRevisora}" href="/2.0/secretaria/temas/agregar.xhtml?prop=#{verPropuestaMB.propuesta.idPropuesta}" value="Agregar Tema"/>
                            <p:button style="width:150px;" rendered="#{not empty verPropuestaMB.propuesta.idRevisora.idTema}" href="/2.0/secretaria/temas/tema.xhtml?tema=#{verPropuestaMB.propuesta.idRevisora.idTema.idTema}" value="Ver Tema"/>
                            <p:button style="width:150px;" href="/2.0/secretaria/propuestas/editarProp.xhtml?prop=#{verPropuestaMB.propuesta.idPropuesta}" value="Editar Propuesta"/>
                            <p:commandButton style="width:150px;" value="Eliminar Propuesta" onclick="confirmation.show()" type="button"/>
                            <p:button style="background: #FFBABA;border: none;" icon="ui-icon-triangle-1-w" href="index.xhtml" value="Volver a Propuestas"/>
                        </h:panelGrid>

                        <p:dialog modal="true" appendToBody="true" header="Confirmación" widgetVar="confirmation" width="350" closeOnEscape="true" closable="true" draggable="false" resizable="false" >
                            <strong>¿Está seguro? Esta acción generará los siguientes cambios dentro del sistema.</strong><br/>
                            <ul>
                                <li>Se eliminará la <strong>Comisión Correctora</strong> del tema de la propuesta.</li>
                                <li>Se eliminará el <strong>Borrador Final</strong> del tema de la propuesta.</li>
                                <li>Se eliminará el <strong>Tema</strong> de la propuesta.</li>
                                <li>Se eliminará la <strong>Comisión Revisora</strong> de la propuesta.</li>
                                <li>Se eliminará la <strong>Propuesta</strong>.</li>
                            </ul>
                            <hr/>
                            
                            <p:commandButton value="Sí" oncomplete="confirmation.hide()"
                                             actionListener="#{eliminarMB.removeByPropuesta(verPropuestaMB.idPropuesta)}" process="@this" onsuccess="alert('Datos eliminados correctamente!')" update="growl"/>
                            <p:commandButton value="No" onclick="confirmation.hide()" type="button" />
                           
                        </p:dialog>
                        
                        <p:dialog modal="true" appendToBody="true" header="Mensaje éxito" widgetVar="exito" width="350" closeOnEscape="true" closable="true" draggable="false" resizable="false" >
                            <strong>¿Está seguro? Esta acción generará los siguientes cambios dentro del sistema.</strong><br/>
                            <ul>
                                <li>Se eliminará la <strong>Comisión Correctora</strong> del tema de la propuesta</li>
                                <li>Se eliminará el <strong>Borrador Final</strong> del tema de la propuesta</li>
                                <li>Se eliminará el <strong>Tema</strong> de la propuesta</li>
                                <li>Se eliminará la <strong>Comisión Revisora</strong> de la propuesta</li>
                                <li>Se eliminará la <strong>Propuesta</strong></li>
                            </ul>
                            <hr/>
                            
                            <p:commandButton value="Sí" oncomplete="confirmation.hide()"
                                             actionListener="#{eliminarMB.removeByPropuesta(verPropuestaMB.idPropuesta)}" process="@this" onsuccess="alert('Datos Eliminados!')" update="growl"/>
                            <p:commandButton value="No" onclick="confirmation.hide()" type="button" />
                           
                        </p:dialog>
                        
                    </h:form>
                </p:panel>
                
            </p:layoutUnit>
            
            <p:layoutUnit position="center" size="430" style="border: none;">
                
                <p:dataTable id="guiaTable" var="guia" value="#{verPropuestaMB.propuesta.profePropuestaList}" emptyMessage="No se encontró Guía">
                    <f:facet name="header">
                        Guías
                    </f:facet>
                    <p:column headerText="Nombre">
                        <a class="enlace" href="/SeminarManagement-Maven-web/2.0/secretaria/profesores/profesor.xhtml?prof=#{guia.profesor.rutProfesor}">
                            <h:outputText value="#{guia.profesor.nombreProfesor} #{guia.profesor.apellidoProfesor}"/>
                        </a>
                    </p:column>
                    <p:column headerText="Rol">
                        <h:outputText rendered="#{guia.rolGuia eq 0}" value="Guía"/>
                        <h:outputText rendered="#{guia.rolGuia eq 1}" value="co-Guía"/>
                    </p:column>
                </p:dataTable>
                <br/>
                <p:dataTable id="comRevTable" var="comRev" value="#{verPropuestaMB.propuesta.idRevisora.profeRevisionList}" emptyMessage="No se encontró Comisión Revisora">
                    <f:facet name="header">
                        Comisión Revisora
                    </f:facet>
                    <p:column headerText="Nombre">
                        <a class="enlace" href="/SeminarManagement-Maven-web/2.0/secretaria/profesores/profesor.xhtml?prof=#{comRev.profesor.rutProfesor}">
                            <h:outputText value="#{comRev.profesor.nombreProfesor} #{comRev.profesor.apellidoProfesor}"/>
                        </a>
                    </p:column>
                </p:dataTable>
            </p:layoutUnit>
        
        <c:if test="#{empty param.prop}">
            <p:layoutUnit position="center" style="border:none;">
                Ha ocurrido un error al ingresar a la página. Intente ingresar nuevamente.
            </p:layoutUnit>
        </c:if>
    </ui:define>

</ui:composition>